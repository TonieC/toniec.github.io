<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Win11 Sim — Demo</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#0f1720;
    --accent:#0ea5e9;
    --glass: rgba(255,255,255,0.06);
    --win-bg: linear-gradient(180deg,#0b1220 0%, #0f1724 100%);
    --taskbar: rgba(12,20,30,0.7);
    --panel: rgba(255,255,255,0.04);
    --text:#e6eef6;
    --muted:#9fb0c3;
    --rounded:14px;
    font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }
  html,body{height:100%;margin:0;background:var(--win-bg);color:var(--text);overflow:hidden}
  /* Boot / Splash screens */
  #boot {
    position:fixed;inset:0;display:flex;align-items:center;justify-content:center;flex-direction:column;
    background:linear-gradient(180deg,#071227 0%, #05101b 100%);z-index:9999;transition:opacity .6s ease;
  }
  #boot.hidden{opacity:0;pointer-events:none}
  #boot .logo{width:140px;height:140px;border-radius:20px;background:linear-gradient(135deg,#0ea5e9,#7c3aed);display:flex;align-items:center;justify-content:center;font-weight:800;font-size:48px;box-shadow:0 20px 60px rgba(13,20,30,0.6)}
  #boot .loader{margin-top:18px;font-size:13px;color:var(--muted);opacity:0.95}
  /* Lock screen */
  #lock {position:fixed;inset:0;background:linear-gradient(180deg, rgba(2,6,23,0.6), rgba(2,6,23,0.4));display:flex;align-items:center;justify-content:center;z-index:9000;flex-direction:column}
  #lock.hidden{display:none}
  #lock .card{background:rgba(255,255,255,0.02);padding:28px;border-radius:16px;border:1px solid rgba(255,255,255,0.03);text-align:center}
  #lock .user{font-size:18px;font-weight:700;margin-bottom:6px}
  #lock small{color:var(--muted)}
  /* Desktop */
  #desktop{position:fixed;inset:0;display:block;padding:28px;box-sizing:border-box;overflow:hidden}
  .icons{display:flex;flex-wrap:wrap;gap:16px;align-content:flex-start}
  .icon{width:86px;color:var(--muted);font-size:13px;text-align:center;cursor:default}
  .icon .img{width:64px;height:64px;border-radius:12px;background:var(--panel);display:flex;align-items:center;justify-content:center;margin:auto;font-weight:700;color:var(--accent);box-shadow:0 8px 22px rgba(2,6,23,0.5)}
  .icon label{display:block;margin-top:6px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  /* Right click menu */
  .context {
    position:fixed;background:rgba(8,12,18,0.98);border:1px solid rgba(255,255,255,0.03);padding:8px;border-radius:8px;display:none;z-index:9998;min-width:180px;box-shadow:0 12px 40px rgba(2,6,23,0.6)
  }
  .context .item{padding:8px;border-radius:6px;color:var(--muted);cursor:pointer}
  .context .item:hover{background:rgba(255,255,255,0.02);color:var(--text)}
  /* Taskbar */
  .taskbar {position:fixed;left:0;right:0;bottom:10px;height:56px;display:flex;align-items:center;justify-content:center;z-index:9997}
  .task-inner{width:92%;max-width:1180px;background:var(--taskbar);backdrop-filter:blur(6px);border-radius:12px;padding:6px 12px;display:flex;align-items:center;justify-content:space-between;box-shadow:0 10px 30px rgba(2,6,23,0.5)}
  .task-left{display:flex;gap:10px;align-items:center}
  .start-btn{width:44px;height:44;border-radius:10px;background:linear-gradient(135deg,#ffffff10,#ffffff06);display:flex;align-items:center;justify-content:center;cursor:pointer}
  .pin{width:44px;height:44;border-radius:8px;background:transparent;display:flex;align-items:center;justify-content:center;color:var(--muted);cursor:pointer}
  .task-right{display:flex;gap:12px;align-items:center;color:var(--muted)}
  .clock{font-weight:600}
  /* Start menu */
  #startMenu{position:fixed;left:20px;bottom:80px;width:420px;background:rgba(8,12,18,0.98);border-radius:16px;padding:14px;display:none;z-index:9999;box-shadow:0 30px 90px rgba(2,6,23,0.6)}
  #startMenu .search{background:rgba(255,255,255,0.03);padding:8px;border-radius:10px;display:flex;gap:8px;align-items:center}
  #startMenu .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:10px}
  .app-tile{background:var(--panel);padding:10px;border-radius:10px;text-align:center;font-size:13px;color:var(--muted);cursor:pointer}
  .app-tile:hover{background:rgba(255,255,255,0.02);color:var(--text)}
  /* Window system */
  .win{
    position:absolute;background:rgba(3,8,14,0.95);border-radius:12px;border:1px solid rgba(255,255,255,0.04);box-shadow:0 30px 90px rgba(2,6,23,0.6);overflow:hidden;display:flex;flex-direction:column;min-width:320px;min-height:160px;
  }
  .win .titlebar{height:42px;display:flex;align-items:center;justify-content:space-between;padding:0 10px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent)}
  .win .title{display:flex;align-items:center;gap:8px;font-weight:700}
  .win .controls{display:flex;gap:8px}
  .btn{width:34px;height:32;border-radius:6px;display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--muted)}
  .btn:hover{background:rgba(255,255,255,0.02);color:var(--text)}
  .win .content{padding:12px;flex:1;overflow:auto}
  .hidden{display:none !important}
  /* small app specifics */
  .file-list{background:rgba(255,255,255,0.02);padding:8px;border-radius:8px}
  .file{padding:8px;border-radius:8px;cursor:pointer;color:var(--muted)}
  .file:hover{background:rgba(255,255,255,0.02);color:var(--text)}
  textarea.notepad{width:100%;height:320px;background:transparent;border:1px dashed rgba(255,255,255,0.03);color:var(--text);padding:8px;border-radius:6px;resize:vertical}
  /* small helpers */
  .drag-handle{cursor:grab}
</style>
</head>
<body>

<!-- Boot screen -->
<div id="boot" aria-hidden="false">
  <div class="logo">W</div>
  <div class="loader">Starting Windows…</div>
</div>

<!-- Lock screen -->
<div id="lock" aria-hidden="false">
  <div class="card">
    <div style="font-weight:800;font-size:20px" id="userName">Tonie</div>
    <small>Click to unlock</small>
  </div>
</div>

<!-- Desktop area -->
<div id="desktop" role="application" aria-label="Desktop">
  <div class="icons" id="icons">
    <div class="icon" data-app="explorer" tabindex="0">
      <div class="img">EX</div>
      <label>File Explorer</label>
    </div>
    <div class="icon" data-app="notepad">
      <div class="img">NP</div>
      <label>Notepad</label>
    </div>
    <div class="icon" data-app="calc">
      <div class="img">C</div>
      <label>Calculator</label>
    </div>
    <div class="icon" data-app="terminal">
      <div class="img">T</div>
      <label>Terminal</label>
    </div>
  </div>
</div>

<!-- Context menu -->
<div id="ctxMenu" class="context" role="menu" aria-hidden="true">
  <div class="item" data-act="new-folder">New → Folder</div>
  <div class="item" data-act="refresh">Refresh</div>
  <div class="item" data-act="personalize">Personalize</div>
</div>

<!-- Start menu -->
<div id="startMenu" aria-hidden="true">
  <div class="search"><input id="startSearch" placeholder="Type here to search" style="background:transparent;border:none;outline:none;color:var(--text);width:100%"></div>
  <div class="grid" id="startGrid">
    <!-- tiles populated by JS -->
  </div>
</div>

<!-- Taskbar -->
<div class="taskbar" role="toolbar" aria-label="Taskbar">
  <div class="task-inner">
    <div class="task-left">
      <div class="start-btn" id="startBtn" title="Start" aria-expanded="false">▦</div>
      <div class="pin" id="pinExplorer" title="File Explorer">EX</div>
      <div class="pin" id="pinNotepad" title="Notepad">NP</div>
      <div class="pin" id="pinCalc" title="Calculator">C</div>
    </div>
    <div class="task-right">
      <div class="clock" id="clock"></div>
    </div>
  </div>
</div>

<!-- Window templates appended by JS -->

<script>
/* ================== Configuration ================== */
const CONFIG = {
  username: 'Tonie',            // edit name here
  defaultFiles: [
    {name:'README.txt', content:'This is a fake filesystem. Use for demos only.'},
    {name:'todo.txt', content:'- buy milk\n- finish demo\n- flex UI skills'},
  ]
};
/* ================ Boot sequence ================ */
const bootEl = document.getElementById('boot');
const lockEl = document.getElementById('lock');
const desktop = document.getElementById('desktop');
document.getElementById('userName').textContent = CONFIG.username;

setTimeout(()=>{ // simulate boot time
  bootEl.classList.add('hidden');
  setTimeout(()=> bootEl.style.display='none',700);
}, 1400);

setTimeout(()=>{ // show lock screen for user to click
  lockEl.classList.remove('hidden');
}, 1600);

/* ================ Utilities ================ */
let zIndexCounter = 100;
function focusWindow(win){
  document.querySelectorAll('.win').forEach(w=> w.style.zIndex=90);
  win.style.zIndex = ++zIndexCounter;
}

function makeWin(title, opts={width:520,height:360,x:80,y:80}){
  const id = 'win_'+Date.now();
  const el = document.createElement('div');
  el.className = 'win';
  el.id = id;
  el.style.width = opts.width+'px';
  el.style.height = opts.height+'px';
  el.style.left = (opts.x||80)+'px';
  el.style.top = (opts.y||80)+'px';
  el.innerHTML = `
    <div class="titlebar drag-handle"><div class="title"><strong>${title}</strong></div>
      <div class="controls">
        <div class="btn" data-act="min">━</div>
        <div class="btn" data-act="max">▥</div>
        <div class="btn" data-act="close">✕</div>
      </div>
    </div>
    <div class="content" role="document"></div>
  `;
  document.body.appendChild(el);
  // bring to front on mousedown
  el.addEventListener('mousedown', ()=> focusWindow(el));
  // wire controls
  el.querySelector('[data-act="close"]').addEventListener('click', ()=> el.remove());
  el.querySelector('[data-act="min"]').addEventListener('click', ()=> el.classList.toggle('hidden'));
  el.querySelector('[data-act="max"]').addEventListener('click', ()=> {
    if(el.dataset.max==='true'){
      // restore
      el.style.left = el.dataset.oldLeft; el.style.top = el.dataset.oldTop;
      el.style.width = el.dataset.oldWidth; el.style.height = el.dataset.oldHeight;
      el.dataset.max='false';
    } else {
      // save and maximize
      el.dataset.oldLeft = el.style.left; el.dataset.oldTop = el.style.top;
      el.dataset.oldWidth = el.style.width; el.dataset.oldHeight = el.style.height;
      el.style.left = '8px'; el.style.top='8px';
      el.style.width = (window.innerWidth - 16)+'px';
      el.style.height = (window.innerHeight - 120)+'px';
      el.dataset.max='true';
    }
  });
  // draggable
  const header = el.querySelector('.drag-handle');
  let dragging=false, sx, sy, ox, oy;
  header.addEventListener('pointerdown', (e)=>{
    dragging=true; header.setPointerCapture(e.pointerId);
    sx = e.clientX; sy = e.clientY;
    ox = parseInt(el.style.left); oy = parseInt(el.style.top);
    header.style.cursor='grabbing';
    focusWindow(el);
  });
  window.addEventListener('pointermove', (e)=>{
    if(!dragging) return;
    let nx = ox + (e.clientX - sx);
    let ny = oy + (e.clientY - sy);
    el.style.left = nx + 'px'; el.style.top = ny + 'px';
  });
  window.addEventListener('pointerup', (e)=>{
    dragging=false; header.style.cursor='grab';
  });

  focusWindow(el);
  return el;
}

/* ================ App Implementations ================ */
function openExplorer(){ 
  const win = makeWin('File Explorer',{width:520,height:380,x:120,y:110});
  const cont = win.querySelector('.content');
  const list = document.createElement('div'); list.className='file-list';
  // load files from localStorage or defaults
  let files = JSON.parse(localStorage.getItem('fs')) || CONFIG.defaultFiles;
  files.forEach(f=>{
    const node = document.createElement('div');
    node.className='file';
    node.textContent = f.name;
    node.addEventListener('dblclick', ()=> {
      // if txt open in notepad
      if(f.name.endsWith('.txt')) openNotepad(f.name, f.content);
    });
    list.appendChild(node);
  });
  // new folder button
  const newBtn = document.createElement('button'); newBtn.textContent='New File'; newBtn.style.margin='8px';
  newBtn.addEventListener('click', ()=> {
    const name = prompt('Name the file','notes.txt');
    if(!name) return;
    files.push({name,content:''});
    localStorage.setItem('fs', JSON.stringify(files));
    list.innerHTML=''; files.forEach(f=>{
      const node = document.createElement('div'); node.className='file'; node.textContent=f.name;
      node.addEventListener('dblclick', ()=> { if(f.name.endsWith('.txt')) openNotepad(f.name,f.content); });
      list.appendChild(node);
    });
  });
  cont.appendChild(newBtn);
  cont.appendChild(list);
}

function openNotepad(name='untitled.txt', content=''){
  const win = makeWin(name,{width:600,height:420,x:140,y:140});
  const cont = win.querySelector('.content');
  const ta = document.createElement('textarea');
  ta.className='notepad';
  // attempt to load saved version from localStorage per filename
  const saved = localStorage.getItem('note:'+name);
  ta.value = saved ?? content;
  const saveBtn = document.createElement('button'); saveBtn.textContent='Save'; saveBtn.style.margin='8px';
  saveBtn.addEventListener('click', ()=> {
    localStorage.setItem('note:'+name, ta.value);
    alert('Saved locally to browser storage (demo only).');
  });
  cont.appendChild(saveBtn);
  cont.appendChild(ta);
}

function openCalc(){
  const win = makeWin('Calculator',{width:320,height:420,x:220,y:180});
  const cont = win.querySelector('.content');
  cont.innerHTML = `
    <div style="display:flex;flex-direction:column;gap:8px">
      <input id="calcDisplay" readonly style="font-size:22px;padding:8px;border-radius:6px;background:transparent;border:1px solid rgba(255,255,255,0.03);color:var(--text)"/>
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px">
        ${['7','8','9','/','4','5','6','*','1','2','3','-','0','.','=','+'].map(x=>`<button class="calc-btn">${x}</button>`).join('')}
      </div>
    </div>
  `;
  const display = cont.querySelector('#calcDisplay');
  cont.querySelectorAll('.calc-btn').forEach(b=>{
    b.addEventListener('click', ()=> {
      const v = b.textContent;
      if(v==='='){ try{ display.value = eval(display.value); }catch(e){ display.value='err'; } return; }
      display.value += v;
    });
  });
}

function openTerminal(){
  const win = makeWin('Terminal',{width:600,height:360,x:200,y:130});
  const cont = win.querySelector('.content');
  cont.innerHTML = `<div style="font-family:monospace;font-size:13px"><div id="termOut">Mock Terminal — type "help"</div><input id="termIn" style="width:100%;margin-top:8px;background:transparent;border:1px solid rgba(255,255,255,0.03);padding:8px;border-radius:6px;color:var(--text)"/></div>`;
  const out = cont.querySelector('#termOut');
  const input = cont.querySelector('#termIn');
  input.addEventListener('keydown', (e)=> {
    if(e.key === 'Enter'){
      const cmd = input.value.trim().toLowerCase(); input.value='';
      if(cmd==='help'){ out.innerHTML += '<div>help, echo, date, clear</div>'; }
      else if(cmd.startsWith('echo ')){ out.innerHTML += '<div>'+cmd.slice(5)+'</div>'; }
      else if(cmd==='date'){ out.innerHTML += '<div>'+new Date().toString()+'</div>'; }
      else if(cmd==='clear'){ out.innerHTML = ''; }
      else out.innerHTML += `<div>Unknown: ${cmd}</div>`;
      out.scrollTop = out.scrollHeight;
    }
  });
}

/* ================ Desktop interactions ================ */
document.getElementById('icons').addEventListener('dblclick', (e)=>{
  const ic = e.target.closest('.icon');
  if(!ic) return;
  const app = ic.dataset.app;
  if(app==='explorer') openExplorer();
  if(app==='notepad') openNotepad('note.txt','');
  if(app==='calc') openCalc();
  if(app==='terminal') openTerminal();
});

/* Right click on desktop */
const ctx = document.getElementById('ctxMenu');
window.addEventListener('contextmenu', (e)=>{
  e.preventDefault();
  // show only for desktop right-click (not when clicking windows)
  if(e.target.closest('.win')) { // window context maybe different — allow native
    return;
  }
  ctx.style.left = e.clientX+'px'; ctx.style.top = e.clientY+'px'; ctx.style.display='block';
  ctx.setAttribute('aria-hidden','false');
});
window.addEventListener('click', ()=> { ctx.style.display='none'; ctx.setAttribute('aria-hidden','true'); });

ctx.addEventListener('click', (e)=>{
  const it = e.target.closest('.item'); if(!it) return;
  const act = it.dataset.act;
  if(act==='new-folder'){
    // create a new file in fake fs
    const files = JSON.parse(localStorage.getItem('fs')) || CONFIG.defaultFiles;
    const name = prompt('New file name','new-file.txt');
    if(!name) return;
    files.push({name,content:''});
    localStorage.setItem('fs', JSON.stringify(files));
    alert('Created '+name+' in demo filesystem.');
  } else if(act==='refresh'){ location.reload(); }
  else if(act==='personalize'){ openSettings(); }
});

/* Start button */
const startBtn = document.getElementById('startBtn');
const startMenu = document.getElementById('startMenu');
startBtn.addEventListener('click', (e)=> {
  const visible = startMenu.style.display === 'block';
  startMenu.style.display = visible ? 'none' : 'block';
  startBtn.setAttribute('aria-expanded', !visible);
});
document.addEventListener('click', (e)=>{
  if(!e.target.closest('#startMenu') && !e.target.closest('#startBtn')) startMenu.style.display='none';
});

/* Populate start tiles */
const apps = [
  {id:'explorer',name:'File Explorer',cb:openExplorer},
  {id:'notepad',name:'Notepad',cb:()=>openNotepad('note.txt','')},
  {id:'calc',name:'Calculator',cb:openCalc},
  {id:'terminal',name:'Terminal',cb:openTerminal},
  {id:'settings',name:'Settings',cb:openSettings},
];
const startGrid = document.getElementById('startGrid');
apps.forEach(a=>{
  const t = document.createElement('div'); t.className='app-tile'; t.textContent=a.name;
  t.addEventListener('click', ()=> { a.cb(); startMenu.style.display='none'; });
  startGrid.appendChild(t);
});

/* Pins on taskbar */
document.getElementById('pinExplorer').addEventListener('click', openExplorer);
document.getElementById('pinNotepad').addEventListener('click', ()=> openNotepad('note.txt',''));
document.getElementById('pinCalc').addEventListener('click', openCalc);

/* Clock */
function refreshClock(){ const d=new Date(); document.getElementById('clock').textContent = d.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'}); }
setInterval(refreshClock, 1000); refreshClock();

/* Unlock lock screen */
lockEl.addEventListener('click', ()=> { lockEl.classList.add('hidden'); });

/* Settings app */
function openSettings(){
  const win = makeWin('Settings',{width:520,height:460,x:160,y:120});
  const cont = win.querySelector('.content');
  cont.innerHTML = `
    <div style="display:flex;flex-direction:column;gap:12px">
      <div style="font-weight:700">Personalization</div>
      <div style="display:flex;gap:8px;align-items:center">
        <div>Theme</div>
        <select id="themeSel">
          <option value="dark">Dark</option>
          <option value="light">Light</option>
        </select>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <div>Username</div>
        <input id="userInput" value="${CONFIG.username}" />
        <button id="saveUser">Save</button>
      </div>
      <div style="color:var(--muted);font-size:13px;margin-top:6px">Changes are local to this browser demo.</div>
    </div>
  `;
  cont.querySelector('#saveUser').addEventListener('click', ()=>{
    const v = cont.querySelector('#userInput').value.trim();
    if(v){ document.getElementById('userName').textContent = v; CONFIG.username = v; alert('Saved demo username (local only).'); }
  });
  cont.querySelector('#themeSel').addEventListener('change', (e)=> {
    if(e.target.value==='light'){
      document.documentElement.style.setProperty('--win-bg', 'linear-gradient(180deg,#f7fbff,#eef6ff)');
      document.body.style.background = 'linear-gradient(180deg,#f7fbff,#eef6ff)';
      // slight inversion of text colors for demo
      document.documentElement.style.setProperty('--text','#0b1a2b');
    } else {
      document.body.style.background = 'var(--win-bg)';
      document.documentElement.style.setProperty('--text','#e6eef6');
    }
  });
}

/* Accessibility: keyboard shortcuts */
window.addEventListener('keydown', (e)=>{
  if(e.key === 'Escape'){
    // close topmost window
    const wins = [...document.querySelectorAll('.win')]; if(wins.length) wins[wins.length-1].remove();
  }
  if(e.ctrlKey && e.key.toLowerCase()==='n'){ openNotepad(); }
});

/* Prevent accidental drag of text causing selection during drag */
window.addEventListener('dragstart', (e)=> e.preventDefault());

/* End of script */
</script>

</body>
</html>
